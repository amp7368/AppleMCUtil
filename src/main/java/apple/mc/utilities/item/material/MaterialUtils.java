package apple.mc.utilities.item.material;

import static org.bukkit.Material.ACACIA_BUTTON;
import static org.bukkit.Material.ACACIA_FENCE;
import static org.bukkit.Material.ACACIA_LEAVES;
import static org.bukkit.Material.ACACIA_LOG;
import static org.bukkit.Material.ACACIA_PLANKS;
import static org.bukkit.Material.ACACIA_SLAB;
import static org.bukkit.Material.ACACIA_TRAPDOOR;
import static org.bukkit.Material.ACACIA_WOOD;
import static org.bukkit.Material.ALLIUM;
import static org.bukkit.Material.ARROW;
import static org.bukkit.Material.AZALEA_LEAVES;
import static org.bukkit.Material.AZURE_BLUET;
import static org.bukkit.Material.BIRCH_BUTTON;
import static org.bukkit.Material.BIRCH_FENCE;
import static org.bukkit.Material.BIRCH_LEAVES;
import static org.bukkit.Material.BIRCH_LOG;
import static org.bukkit.Material.BIRCH_PLANKS;
import static org.bukkit.Material.BIRCH_SLAB;
import static org.bukkit.Material.BIRCH_TRAPDOOR;
import static org.bukkit.Material.BIRCH_WOOD;
import static org.bukkit.Material.BLACK_CARPET;
import static org.bukkit.Material.BLUE_CARPET;
import static org.bukkit.Material.BLUE_ORCHID;
import static org.bukkit.Material.BOW;
import static org.bukkit.Material.BROWN_CARPET;
import static org.bukkit.Material.CHAINMAIL_BOOTS;
import static org.bukkit.Material.CHAINMAIL_CHESTPLATE;
import static org.bukkit.Material.CHAINMAIL_HELMET;
import static org.bukkit.Material.CHAINMAIL_LEGGINGS;
import static org.bukkit.Material.CORNFLOWER;
import static org.bukkit.Material.CRIMSON_BUTTON;
import static org.bukkit.Material.CRIMSON_FENCE;
import static org.bukkit.Material.CRIMSON_HYPHAE;
import static org.bukkit.Material.CRIMSON_PLANKS;
import static org.bukkit.Material.CRIMSON_SLAB;
import static org.bukkit.Material.CRIMSON_STEM;
import static org.bukkit.Material.CRIMSON_TRAPDOOR;
import static org.bukkit.Material.CROSSBOW;
import static org.bukkit.Material.CYAN_CARPET;
import static org.bukkit.Material.DANDELION;
import static org.bukkit.Material.DARK_OAK_BUTTON;
import static org.bukkit.Material.DARK_OAK_FENCE;
import static org.bukkit.Material.DARK_OAK_LEAVES;
import static org.bukkit.Material.DARK_OAK_LOG;
import static org.bukkit.Material.DARK_OAK_PLANKS;
import static org.bukkit.Material.DARK_OAK_SLAB;
import static org.bukkit.Material.DARK_OAK_TRAPDOOR;
import static org.bukkit.Material.DARK_OAK_WOOD;
import static org.bukkit.Material.DETECTOR_RAIL;
import static org.bukkit.Material.DIAMOND_BOOTS;
import static org.bukkit.Material.DIAMOND_CHESTPLATE;
import static org.bukkit.Material.DIAMOND_HELMET;
import static org.bukkit.Material.DIAMOND_LEGGINGS;
import static org.bukkit.Material.FERN;
import static org.bukkit.Material.FIRE;
import static org.bukkit.Material.FLOWERING_AZALEA_LEAVES;
import static org.bukkit.Material.FLOWER_POT;
import static org.bukkit.Material.GOLDEN_BOOTS;
import static org.bukkit.Material.GOLDEN_CHESTPLATE;
import static org.bukkit.Material.GOLDEN_HELMET;
import static org.bukkit.Material.GOLDEN_LEGGINGS;
import static org.bukkit.Material.GRASS;
import static org.bukkit.Material.GRAY_CARPET;
import static org.bukkit.Material.GREEN_CARPET;
import static org.bukkit.Material.IRON_BOOTS;
import static org.bukkit.Material.IRON_CHESTPLATE;
import static org.bukkit.Material.IRON_HELMET;
import static org.bukkit.Material.IRON_LEGGINGS;
import static org.bukkit.Material.IRON_TRAPDOOR;
import static org.bukkit.Material.JUNGLE_BUTTON;
import static org.bukkit.Material.JUNGLE_FENCE;
import static org.bukkit.Material.JUNGLE_LEAVES;
import static org.bukkit.Material.JUNGLE_LOG;
import static org.bukkit.Material.JUNGLE_PLANKS;
import static org.bukkit.Material.JUNGLE_SLAB;
import static org.bukkit.Material.JUNGLE_TRAPDOOR;
import static org.bukkit.Material.JUNGLE_WOOD;
import static org.bukkit.Material.LARGE_FERN;
import static org.bukkit.Material.LEATHER_BOOTS;
import static org.bukkit.Material.LEATHER_CHESTPLATE;
import static org.bukkit.Material.LEATHER_HELMET;
import static org.bukkit.Material.LEATHER_LEGGINGS;
import static org.bukkit.Material.LIGHT_BLUE_CARPET;
import static org.bukkit.Material.LIGHT_GRAY_CARPET;
import static org.bukkit.Material.LILAC;
import static org.bukkit.Material.LILY_OF_THE_VALLEY;
import static org.bukkit.Material.LIME_CARPET;
import static org.bukkit.Material.MAGENTA_CARPET;
import static org.bukkit.Material.MANGROVE_LEAVES;
import static org.bukkit.Material.MANGROVE_LOG;
import static org.bukkit.Material.MANGROVE_PLANKS;
import static org.bukkit.Material.MANGROVE_SLAB;
import static org.bukkit.Material.MANGROVE_TRAPDOOR;
import static org.bukkit.Material.MANGROVE_WOOD;
import static org.bukkit.Material.NETHERITE_BOOTS;
import static org.bukkit.Material.NETHERITE_CHESTPLATE;
import static org.bukkit.Material.NETHERITE_HELMET;
import static org.bukkit.Material.NETHERITE_LEGGINGS;
import static org.bukkit.Material.OAK_BUTTON;
import static org.bukkit.Material.OAK_FENCE;
import static org.bukkit.Material.OAK_LEAVES;
import static org.bukkit.Material.OAK_LOG;
import static org.bukkit.Material.OAK_PLANKS;
import static org.bukkit.Material.OAK_SLAB;
import static org.bukkit.Material.OAK_TRAPDOOR;
import static org.bukkit.Material.OAK_WOOD;
import static org.bukkit.Material.ORANGE_CARPET;
import static org.bukkit.Material.ORANGE_TULIP;
import static org.bukkit.Material.OXEYE_DAISY;
import static org.bukkit.Material.PEONY;
import static org.bukkit.Material.PINK_CARPET;
import static org.bukkit.Material.PINK_TULIP;
import static org.bukkit.Material.POLISHED_BLACKSTONE_BUTTON;
import static org.bukkit.Material.POPPY;
import static org.bukkit.Material.POWERED_RAIL;
import static org.bukkit.Material.PURPLE_CARPET;
import static org.bukkit.Material.RAIL;
import static org.bukkit.Material.REDSTONE;
import static org.bukkit.Material.RED_CARPET;
import static org.bukkit.Material.RED_TULIP;
import static org.bukkit.Material.ROSE_BUSH;
import static org.bukkit.Material.SNOW;
import static org.bukkit.Material.SOUL_FIRE;
import static org.bukkit.Material.SPECTRAL_ARROW;
import static org.bukkit.Material.SPRUCE_BUTTON;
import static org.bukkit.Material.SPRUCE_FENCE;
import static org.bukkit.Material.SPRUCE_LEAVES;
import static org.bukkit.Material.SPRUCE_LOG;
import static org.bukkit.Material.SPRUCE_PLANKS;
import static org.bukkit.Material.SPRUCE_SLAB;
import static org.bukkit.Material.SPRUCE_TRAPDOOR;
import static org.bukkit.Material.SPRUCE_WOOD;
import static org.bukkit.Material.STONE_BUTTON;
import static org.bukkit.Material.STRING;
import static org.bukkit.Material.STRIPPED_ACACIA_LOG;
import static org.bukkit.Material.STRIPPED_ACACIA_WOOD;
import static org.bukkit.Material.STRIPPED_BIRCH_LOG;
import static org.bukkit.Material.STRIPPED_BIRCH_WOOD;
import static org.bukkit.Material.STRIPPED_CRIMSON_HYPHAE;
import static org.bukkit.Material.STRIPPED_CRIMSON_STEM;
import static org.bukkit.Material.STRIPPED_DARK_OAK_LOG;
import static org.bukkit.Material.STRIPPED_DARK_OAK_WOOD;
import static org.bukkit.Material.STRIPPED_JUNGLE_LOG;
import static org.bukkit.Material.STRIPPED_JUNGLE_WOOD;
import static org.bukkit.Material.STRIPPED_MANGROVE_LOG;
import static org.bukkit.Material.STRIPPED_MANGROVE_WOOD;
import static org.bukkit.Material.STRIPPED_OAK_LOG;
import static org.bukkit.Material.STRIPPED_OAK_WOOD;
import static org.bukkit.Material.STRIPPED_SPRUCE_LOG;
import static org.bukkit.Material.STRIPPED_SPRUCE_WOOD;
import static org.bukkit.Material.STRIPPED_WARPED_HYPHAE;
import static org.bukkit.Material.STRIPPED_WARPED_STEM;
import static org.bukkit.Material.SUNFLOWER;
import static org.bukkit.Material.TALL_GRASS;
import static org.bukkit.Material.TIPPED_ARROW;
import static org.bukkit.Material.TURTLE_HELMET;
import static org.bukkit.Material.WARPED_BUTTON;
import static org.bukkit.Material.WARPED_FENCE;
import static org.bukkit.Material.WARPED_PLANKS;
import static org.bukkit.Material.WARPED_SLAB;
import static org.bukkit.Material.WARPED_STEM;
import static org.bukkit.Material.WARPED_TRAPDOOR;
import static org.bukkit.Material.WHITE_CARPET;
import static org.bukkit.Material.WHITE_TULIP;
import static org.bukkit.Material.WITHER_ROSE;
import static org.bukkit.Material.YELLOW_CARPET;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.HashSet;
import java.util.List;
import java.util.Set;
import org.bukkit.Material;
import org.bukkit.inventory.RecipeChoice;
import org.jetbrains.annotations.Nullable;

public class MaterialUtils {

    public static final MaterialUtils FLOWERS = new MaterialUtils(
        List.of(CORNFLOWER, DANDELION, POPPY, BLUE_ORCHID, ALLIUM, AZURE_BLUET, ORANGE_TULIP,
            RED_TULIP, PINK_TULIP, WHITE_TULIP, OXEYE_DAISY, LILY_OF_THE_VALLEY, WITHER_ROSE,
            SUNFLOWER, LILAC, ROSE_BUSH, PEONY));
    public static final MaterialUtils LOGS = new MaterialUtils(
        List.of(OAK_LOG, SPRUCE_LOG, BIRCH_LOG, JUNGLE_LOG, ACACIA_LOG, DARK_OAK_LOG, MANGROVE_LOG,
            CRIMSON_STEM, WARPED_STEM));
    public static final MaterialUtils STRIPPED_LOGS = new MaterialUtils(
        List.of(STRIPPED_OAK_LOG, STRIPPED_SPRUCE_LOG, STRIPPED_BIRCH_LOG, STRIPPED_JUNGLE_LOG,
            STRIPPED_ACACIA_LOG, STRIPPED_DARK_OAK_LOG, STRIPPED_MANGROVE_LOG,
            STRIPPED_CRIMSON_STEM, STRIPPED_WARPED_STEM));
    public static final MaterialUtils PLANKS = new MaterialUtils(
        List.of(OAK_PLANKS, SPRUCE_PLANKS, BIRCH_PLANKS, JUNGLE_PLANKS, ACACIA_PLANKS,
            DARK_OAK_PLANKS, MANGROVE_PLANKS, CRIMSON_PLANKS, WARPED_PLANKS));
    public static final MaterialUtils WOOD_SLABS = new MaterialUtils(
        List.of(OAK_SLAB, SPRUCE_SLAB, BIRCH_SLAB, JUNGLE_SLAB, ACACIA_SLAB, DARK_OAK_SLAB,
            MANGROVE_SLAB, CRIMSON_SLAB, WARPED_SLAB));
    public static final MaterialUtils WOOD_TRAPDOORS = new MaterialUtils(
        List.of(OAK_TRAPDOOR, SPRUCE_TRAPDOOR, BIRCH_TRAPDOOR, JUNGLE_TRAPDOOR, ACACIA_TRAPDOOR,
            DARK_OAK_TRAPDOOR, MANGROVE_TRAPDOOR, CRIMSON_TRAPDOOR, WARPED_TRAPDOOR));
    private final static Collection<Material> ARROWS = Arrays.asList(ARROW, SPECTRAL_ARROW, TIPPED_ARROW);
    private static final Collection<Material> TREE_WOOD_BARK = new HashSet<>(
        List.of(BIRCH_WOOD, ACACIA_WOOD, DARK_OAK_WOOD, JUNGLE_WOOD, SPRUCE_WOOD, OAK_WOOD, MANGROVE_WOOD, CRIMSON_HYPHAE,
            CRIMSON_HYPHAE)
    );
    private static final Collection<Material> TREE_WOOD_LOG = new HashSet<>(
        List.of(BIRCH_LOG, ACACIA_LOG, DARK_OAK_LOG, JUNGLE_LOG, SPRUCE_LOG, OAK_LOG, MANGROVE_LOG, CRIMSON_STEM, CRIMSON_STEM)
    );
    private static final Collection<Material> TREE_WOOD_STRIPPED = new HashSet<>(
        List.of(
            STRIPPED_BIRCH_WOOD, STRIPPED_ACACIA_WOOD, STRIPPED_DARK_OAK_WOOD, STRIPPED_JUNGLE_WOOD,
            STRIPPED_SPRUCE_WOOD, STRIPPED_OAK_WOOD, STRIPPED_MANGROVE_WOOD, STRIPPED_CRIMSON_HYPHAE, STRIPPED_WARPED_HYPHAE,

            STRIPPED_BIRCH_LOG, STRIPPED_ACACIA_LOG, STRIPPED_DARK_OAK_LOG, STRIPPED_JUNGLE_LOG,
            STRIPPED_SPRUCE_LOG, STRIPPED_OAK_LOG, STRIPPED_MANGROVE_LOG, STRIPPED_CRIMSON_STEM, STRIPPED_WARPED_STEM
        )
    );
    private static final Collection<Material> TREE_WOOD = new HashSet<>() {{
        addAll(TREE_WOOD_BARK);
        addAll(TREE_WOOD_LOG);
        addAll(TREE_WOOD_STRIPPED);
    }};
    private static final Collection<Material> LEAVES = new HashSet<>(List.of(BIRCH_LEAVES, ACACIA_LEAVES,
        DARK_OAK_LEAVES, JUNGLE_LEAVES, SPRUCE_LEAVES, OAK_LEAVES, AZALEA_LEAVES, MANGROVE_LEAVES, FLOWERING_AZALEA_LEAVES));
    private static final Collection<Material> FENCE = List.of(BIRCH_FENCE, ACACIA_FENCE,
        DARK_OAK_FENCE, JUNGLE_FENCE, SPRUCE_FENCE, OAK_FENCE, WARPED_FENCE, CRIMSON_FENCE);
    private final static Collection<Material> BUTTONS = Arrays.asList(BIRCH_BUTTON, ACACIA_BUTTON,
        DARK_OAK_BUTTON, JUNGLE_BUTTON, SPRUCE_BUTTON, OAK_BUTTON, WARPED_BUTTON, CRIMSON_BUTTON,
        POLISHED_BLACKSTONE_BUTTON, STONE_BUTTON);
    private final static Collection<Material> TRAP_DOORS = Arrays.asList(BIRCH_TRAPDOOR,
        ACACIA_TRAPDOOR, DARK_OAK_TRAPDOOR, JUNGLE_TRAPDOOR, SPRUCE_TRAPDOOR, OAK_TRAPDOOR,
        WARPED_TRAPDOOR, CRIMSON_TRAPDOOR, IRON_TRAPDOOR);
    private final static Collection<Material> CARPETS = Arrays.asList(WHITE_CARPET, ORANGE_CARPET,
        MAGENTA_CARPET, LIGHT_BLUE_CARPET, YELLOW_CARPET, LIME_CARPET, PINK_CARPET, GRAY_CARPET,
        LIGHT_GRAY_CARPET, CYAN_CARPET, PURPLE_CARPET, BLUE_CARPET, BROWN_CARPET, GREEN_CARPET,
        RED_CARPET, BLACK_CARPET);
    private static final Collection<Material> walkThroughable = new HashSet<>(
        Arrays.asList(SNOW, GRASS, FERN, FLOWER_POT, TALL_GRASS, LARGE_FERN, REDSTONE, STRING, FIRE,
            RAIL, POWERED_RAIL, DETECTOR_RAIL, SOUL_FIRE)) {{
        addAll(TRAP_DOORS);
        addAll(BUTTONS);
        addAll(CARPETS);
    }};
    private static final Collection<Material> helmets = Arrays.asList(LEATHER_HELMET, GOLDEN_HELMET,
        CHAINMAIL_HELMET, IRON_HELMET, DIAMOND_HELMET, NETHERITE_HELMET, TURTLE_HELMET);
    private static final Collection<Material> chestplates = Arrays.asList(LEATHER_CHESTPLATE,
        GOLDEN_CHESTPLATE, CHAINMAIL_CHESTPLATE, IRON_CHESTPLATE, DIAMOND_CHESTPLATE,
        NETHERITE_CHESTPLATE);
    private static final Collection<Material> leggings = Arrays.asList(LEATHER_LEGGINGS,
        GOLDEN_LEGGINGS, CHAINMAIL_LEGGINGS, IRON_LEGGINGS, DIAMOND_LEGGINGS, NETHERITE_LEGGINGS);
    private static final Collection<Material> boots = Arrays.asList(LEATHER_BOOTS, GOLDEN_BOOTS,
        CHAINMAIL_BOOTS, IRON_BOOTS, DIAMOND_BOOTS, NETHERITE_BOOTS);
    private static final Collection<Material> armor = new HashSet<>() {{
        addAll(helmets);
        addAll(chestplates);
        addAll(leggings);
        addAll(boots);
    }};
    private final Set<Material> materialsSet;
    private final List<Material> materialsList;

    public MaterialUtils(List<Material> materials) {
        this.materialsSet = new HashSet<>(materials);
        this.materialsList = materials;
    }

    @Nullable
    public static ArmorType getArmorType(Material m) {
        if (armor.contains(m)) {
            if (helmets.contains(m))
                return ArmorType.HELMET;
            if (chestplates.contains(m))
                return ArmorType.CHESTPLATE;
            if (leggings.contains(m))
                return ArmorType.LEGGINGS;
            if (boots.contains(m))
                return ArmorType.BOOTS;
        }
        return null;
    }

    public static boolean isArrow(Material m) {
        return ARROWS.contains(m);
    }

    public static boolean isFence(Material m) {
        return FENCE.contains(m);
    }

    public static boolean isBowLike(Material m) {
        return BOW == m || CROSSBOW == m;
    }

    public static boolean isPassable(Material m) {
        return m.isAir() || m == SNOW;
    }

    public static boolean isWalkThroughable(Material m) {
        return m.isAir() || walkThroughable.contains(m);
    }

    public static boolean isTree(Material m) {
        return LEAVES.contains(m) || TREE_WOOD.contains(m);
    }

    public RecipeChoice.MaterialChoice materialChoice() {
        return new RecipeChoice.MaterialChoice(this.materialsList);
    }

    public List<Material> getList() {
        return this.materialsList;
    }

    public Set<Material> getSet() {
        return this.materialsSet;
    }

    public MaterialUtils join(MaterialUtils other) {
        return new MaterialUtils(new ArrayList<>(this.getList()) {{
            addAll(other.getList());
        }});
    }
}
